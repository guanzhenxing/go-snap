# go-snap

本脚手架旨在提供一个标准化、模块化、可扩展的 Go 应用开发框架，适用于构建从小型服务到大型企业级应用的各种场景。它结合了业界最佳实践和经验，为开发团队提供一个一致的开发环境和架构方案。遵循以下设计理念：

1. **简洁高效**：提供简洁的 API，减少样板代码，提高开发效率
2. **模块解耦**：框架核心与应用分离，模块间松耦合，便于按需引入
3. **约定优于配置**：提供合理默认值，减少配置工作，同时保留灵活性和通过配置覆盖默认行为的能力
4. **面向接口**：通过接口定义组件行为，降低模块间依赖，提高可测试性
5. **包容生态**：不重复造轮子，整合 Go 生态中优秀的库和工具（如 Gin、GORM、go-redis、zap 等）
6. **渐进式架构**：核心功能可以独立使用，组件可以按需引入，支持从简单应用到复杂系统的平滑过渡
7. **自动化依赖管理**：使用依赖注入框架简化组件依赖关系，提高代码可测试性和可维护性
8. **反应式设计**：支持异步处理和事件驱动模型，提高系统响应能力和吞吐量

## 核心模块

### Errors 模块

Errors 模块提供了强大而灵活的错误处理机制，使开发者能更好地管理和处理应用中的错误：

- **错误链**：支持错误包装和链式传播，保留完整的错误上下文和调用栈
- **错误类型**：提供常见错误类型（如验证错误、业务错误、系统错误等）
- **错误码**：统一的错误码系统，便于错误分类和客户端处理
- **国际化**：支持错误信息的多语言翻译
- **安全处理**：自动过滤敏感信息，避免在错误信息中泄露敏感数据

### Logger 模块

Logger 模块是一个高性能、功能丰富的日志系统，帮助开发者记录、监控和调试应用：

- **结构化日志**：支持字段化日志记录，便于后续分析和处理
- **多级别日志**：提供 Debug、Info、Warn、Error、Fatal 等多个日志级别
- **多输出目标**：支持同时输出到控制台、文件，支持 JSON 格式
- **数据掩码**：自动掩码敏感信息（如密码、信用卡号等）
- **异步日志**：高性能异步记录，避免阻塞主业务流程
- **上下文集成**：支持从上下文（如 HTTP 请求）中提取信息
- **文件轮转**：支持按大小、时间自动轮转日志文件

### Config 模块

Config 模块提供了一个灵活、强大的配置管理解决方案，基于Viper库实现，简化应用配置管理：

- **多格式支持**：支持YAML、TOML、JSON、环境变量等多种配置格式
- **多环境配置**：轻松切换开发、测试、预生产、生产环境配置
- **热重载**：支持配置动态更新和监听配置变更
- **配置验证**：内置配置参数校验，支持多种验证方式
- **默认值处理**：提供合理的默认配置值
- **配置优先级**：遵循命令行参数 > 环境变量 > 配置文件 > 默认值的优先顺序
- **配置变更通知**：支持组件订阅配置变更事件


### 缓存模块

缓存模块提供了统一的缓存接口和多种实现，支持本地内存缓存和Redis缓存，以及多级缓存机制。

- **统一缓存接口**：通过`Cache`接口抽象不同的缓存实现
- **多级缓存**：支持本地缓存和分布式缓存的组合使用
- **Redis集成**：支持Redis的单机模式、哨兵模式和集群模式
- **自动序列化**：内置JSON和Gob序列化器，自动处理对象的序列化和反序列化
- **缓存策略**：支持TTL、标签等缓存管理策略
- **分布式锁**：提供基于Redis的分布式锁实现


### 分布式锁

分布式锁模块提供了基于Redis的分布式锁实现，用于协调分布式系统中的并发操作。

- **简单API**：提供简洁易用的锁接口
- **Redis实现**：基于Redis的可靠分布式锁实现，使用Lua脚本确保原子性操作
- **自动重试**：支持获取锁时的自动重试机制
- **锁刷新**：支持延长锁的过期时间
- **安全释放**：只有持有锁的客户端才能释放锁
- **缓存集成**：与cache模块无缝集成